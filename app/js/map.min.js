/*
 MIT
 @version 0.1.0
*/
(function(f,k){"object"===typeof exports&&"function"===typeof require?exports.Map=k():"function"===typeof define&&define.amd?define(k):(f.__vm__=f.__vm__||{},f.__vm__.util=f.__vm__.util||{},f.__vm__.util.Map=k())})(this,function(){function f(l,h){for(var f in h)h.hasOwnProperty(f)&&!l.hasOwnProperty(f)&&(l[f]=h[f]);return l}var k=function(l,h,m){h=h||"_";var n={},g;if(Array.isArray(l))g=l;else{var r=0;g=[];f(n,l);for(var p in l)"function"!==typeof l[p]&&(g[r++]=p,n[p]=h)}var e={},q=0;this.toObjectKey=
function(a){if("string"===typeof a){a=a.replace(RegExp("\\\\/","g"),"\ue000").replace(RegExp("\\\\:","g"),"\ue001");a=a.split("/");for(var c={},b=0;b<a.length;b++){var d=a[b],e=d.indexOf(":"),f=-1===e?g[b]:d.substring(0,e),d=-1===e?d:d.substring(e+1),d=d.replace(RegExp("\ue000","g"),"/").replace(RegExp("\ue001","g"),":");c[f]=d}return c}return a};this.toStringKey=function(a,c){function b(a){return a.replace(RegExp(":","g"),"\\:").replace(RegExp("/","g"),"\\/")}"undefined"===typeof c&&(c=!0);if("object"===
typeof a){for(var d="",e=0;e<g.length;e++){var f=a[g[e]];"undefined"!==typeof f&&(0<d.length&&(d+="/"),c&&(d+=b(g[e])+":"),d+=b(f))}return d}return a};this.select=function(a,c){"undefined"===typeof c&&(c=!0);a=this.toObjectKey(a);var b=a[g[0]];if("undefined"!==typeof b){var d=e[b];if(1===g.length)return d;if("undefined"===typeof d){if(c)return e[b]=new k(g.slice(1),h,this),e[b].select(a);return}return d.select(a)}return this};this.get=function(a,c){var b=this.select(f(a,n),!1);return"undefined"!==
typeof b?b:"function"===typeof c?c.call(this):c};this.getOrElseUpdate=function(a,c){var b=this.select(f(a,n),!1);"undefined"===typeof b&&(b="function"===typeof c?c.call(this):c,"undefined"!==typeof b&&this.put(a,b));return b};this.contains=function(a){return"undefined"!==typeof this.get(a)};this.put=function(a,c){a=this.toObjectKey(a);var b=a[g[0]],b="undefined"!==typeof b?b:h,d;1===g.length?(d=e[b],e[b]=c,"undefined"===typeof d&&this.__incrementSize()):((d=e[b])||(e[b]=d=new k(g.slice(1),h,this)),
d=d.put(a,c));return d};this.size=function(){return q};this.remove=function(a){if(e){a=this.toObjectKey(a);var c=a[g[0]],c="undefined"!==typeof c?c:h,b;1===g.length?(b=e[c],delete e[c],"undefined"!==typeof b&&this.__decrementSize()):(c=e[c])&&(b=c.remove(a));return b}};this.clear=this.removeAll=function(){if(e)for(var a in e)1===g.length?(delete e[a],this.__decrementSize()):e[a].clear()};this.each=function(a,c){this.__each({},a,c||this,this)};this.__each=function(a,c,b,d){if(e)for(var h in e)a[g[0]]=
h,1===g.length?c.call(b,f({},a),e[h],d):e[h].__each(a,c,b,d)};this.__incrementSize=function(){q++;m&&m.__incrementSize()};this.__decrementSize=function(){q--;m&&m.__decrementSize()}};k.create=function(f,h){return new k(f,h)};return k});